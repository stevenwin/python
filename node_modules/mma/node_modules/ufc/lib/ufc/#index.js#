
/*

  UFC Fighter API in NodeJS
  -------------------------
  Crawler and Parser for UFC.com Fighter Profiles

  Copyright: (c) 2015 Andrew Valish
  License: BSD, see LICENSE for more details

*/

var request = require("request");
var cheerio = require("cheerio");
var google = require("google");

//-------------------------------------------------------+
//  Get Fighter Profile Data
//  ufc.fighter(url, callback(data));
//-------------------------------------------------------+

module.exports.fighter = function(query, callback) {

  google(query + ' ufc', function(err, next, links) {
    if (err) console.error(err);

    var ufc_url;
    var fighter = {
      nickname: ""
    };

    for (var i = 0; i < links.length; ++i) {
      var resultContains = function(link, query) {
        if (link.href !== null) {
          if (link.href.indexOf(query) > -1) { return true; }
        }
      }
      if (resultContains(links[i], "ufc.com/fighter/")) {
        ufc_url = links[i].href;
      }
    }

    callback(ufc_url);
  });
  
}

